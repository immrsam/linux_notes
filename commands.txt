 LINUX commands
sudo: root access (superuser)

copy multiple file types to a dir: cp -v *.{txt,jpg,png} destination/ 

lsblk: list of connected drives

apt-get: Installs, upgrades and uninstalls packages.
apt-cache: This works with the repository index files, such as searching for packages.
add-apt-repository: Adds extra repositories to the system.
dpkg: A lower level package manipulation command.

adduser [username]: create new user
groups: list of groups current user belongs to
groups [username]: list of groups a specific user belongs to

list modules in kernel: lsmod
look for raid: modprobe raid(number)

check current shell: ls -l /bin/sh

sudo usermod -aG sudo [username]: add user to a group

start=5
end=12
for num in $( seq $start $end ) ; do echo $num ; done

ssh-keygen -R <host>: reset host key

sudo apt-get remove  openssh-server
sudo apt-get install  openssh-server
sudo service ssh --full-restart

sudo apt purge tigervnc-standalone-server tightvncserver -y && sudo apt autoremove -y && sudo apt install tigervnc-standalone-server -y
sudo apt purge tigervnc-common tigervnc-xorg-extension tigervnc-viewer tigervnc-standalone-server tigervnc-scraping-server
apt search tigervnc
==============================
----Connecting to X and Pi----
==============================
*************************************************
* Key						*
* ----						*
* WIN  - windows desktop			*
* CMD  - windows command line terminal		*
* WSL1 - windows subsystem linux terminal	*
* WSL2 - second windows subsystem linux terminal*
* PI   - pi terminal				*
*************************************************
*open a terminal on the Pi either remotly or locally*
PI   - uninstall realvnc server (sudo apt remove realvnc-vnc-server)
PI   - install tigervnc server (sudo apt remove tigervnc-standalone-server)
WIN  - Install Vcxsrv or XMing to have the X server on machine
WIN  - Launch XLaunch, choose window option(default to multiple windows), start no client, select Disable access control, finish
WIN  - open command prompt
WIN  - run wsl and then exit
CMD  - run ipconfig, under Ethernet adapter vEthernet (WSL) highlight IPv4 Address and right-click on selection to copy.
CMD  - run WSL
WSL1 - if not already installed, install tigervnc viewer(sudo apt install tigervnc-viewer)
WSL1 - check $DISPLAY variable (echo $DISPLAY) it should be empty
WSL1 - run export DISPLAY=xxx.xx.xx.x:0.0 where the x's are, paste your ip address by rightclicking mouse. Follow this with :0.0 to complete the address.
WSL1 - check $DISPLAY variable again and now it should print out your WSL address with :0.0 at the end.
WIN  - open a new command prompt terminal and run WSL
WSL2 - login to your pi while opening the first port, ssh username@address -L 9901:localhost:5901
WSL2 - vncserver
WSL2 - vncserver -list to see what servers are running
WSL2 - vncserver -kill :* to kill any stale process, replace * with session number
*leave WSL2 open and return to WSL1*
WSL1 - connect Xserver to pi, vncviewer localhost:9901
WIN  - login with Pi password

----------------------
troubleshoot
SSH connections: try
sudo apt-get remove  openssh-server
sudo apt-get install  openssh-server
sudo service ssh --full-restart

==============================
----------Using LVM-----------
==============================
connect to pi over vnc (connecting to X and Pi)
open terminal
install gparted (sudo apt install gparted)
	
**fix gparted issue here** (open from terminal (sudo -E gparted))
-------
GPARTED
-------
insert USB drive
GParted -> Refresh Drives (ctrl+R)
select usb drive that appears. careful not to modify the SD card
Device -> Create Partition Table
Select new partion table type: gpt
apply
right click in the grey box that is marked as unallocated as well as the available space and select New
in the new partition dialog, drag the bar to the size you wish to have the partition allocated, or alternatively manually enter it in the New size (MiB) box.
enter names in the partition name and label, ill use my RMIT id and partition number S3768719_ONE
do this all again on the remaining space of the usb allocating the remaining space. This time we will select the file system lvm2 pv. if this option is greyed out you will need to install it in a terminal (sudo apt-get lvm2)
once both partitions have been created, right click on each one and select Format to -> lvm2 pv
click the green tick in the toolbar to apply all operations and select Apply
once completed, close the application
--------
TERMINAL
--------
lsblk shows the two new volumes in the USB drive but we cannot use them at the moment, they need to be mounted 

vgcreate - Create a volume group
replace s3768719 it what your RMIT ID is.
sudo vgcreate s3768719_vg /dev/sda1 /dev/sda2
OUTPUT-	Volume group "s3768719_vg" successfully created

lvcreate - Create a logical volume
sudo lvcreate -l 100%FREE -n s3768719_lv s3768719_vg
OUTPUT-	Logical volume "s3768719_lv" created.

mkfs - build a Linux filesystem
sudo mkfs.ext4 /dev/s3768719_vg/s3768719_lv
OUTPUT-	mke2fs 1.44.5 (15-Dec-2018)
	Creating filesystem with 3751936 4k blocks and 938400 inodes
	Filesystem UUID: bfca577d-84fb-4a66-bb13-b121e39b4904
	Superblock backups stored on blocks: 
		32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208

	Allocating group tables: done                            
	Writing inode tables: done                            
	Creating journal (16384 blocks): done
	Writing superblocks and filesystem accounting information: done  

create directory for the new volume in home directory called 'data' (mkdir ~/data)

mount volumes
sudo mount /dev/s3768719_vg/s3768719_lv /home/immrsam/DATA
sudo mount /dev/s3768719_vg/s3768719_lv /home/<your login>/data

change permissions to make you owner
sudo chown <your login>: ~/data

automount

/dev/mmcblk0p1: LABEL_FATBOOT="boot" LABEL="boot" UUID="B05C-D0C4" TYPE="vfat" PARTUUID="dc4cb26a-01"
/dev/mmcblk0p2: LABEL="rootfs" UUID="075b0d0c-7b1e-4855-9547-125591698723" TYPE="ext4" PARTUUID="dc4cb26a-02"
/dev/sdc1: UUID="UDOZR0-zRLR-tPzG-sh5L-5ior-jUwQ-db5k1u" TYPE="LVM2_member" PARTLABEL="ONE" PARTUUID="68738638-ce23-47ff-81ce-0ea39c0ca4d0"
/dev/sda1: UUID="DArnuL-Caba-4tKA-kdlD-IdSW-372U-37nPKR" TYPE="LVM2_member" PARTLABEL="TWO" PARTUUID="ea016b33-8622-42e6-ab1d-140ee5632508"
/dev/mmcblk0: PTUUID="dc4cb26a" PTTYPE="dos"
/dev/mapper/s3768719_vg-s3768719_lv: UUID="c7d962ad-4172-4871-a300-02c84bb350a0" TYPE="ext4"

UUID=c7d962ad-4172-4871-a300-02c84bb350a0 /DATA ext4 defaults,auto,users,rw,nofail 0 0
==============================
-------Install docker---------
==============================

************pre install*************
These should already be apart of
your linux enviroment.
If not, install the following;

sudo apt-get install man-db wget git
*************************************

get the docker install script (wget -O get-docker https://get.docker.com/)
change permissions on file to allow execution (sudo chmod 777 get-docker)
run file (./get-docker)
wait around 5 minutes approx

Create the docker group. (if not already)
sudo groupadd docker
Add user to group
sudo usermod -aG docker ${USER}
Log out and back in or use following command
su -s ${USER}

------------------------------------------------------------------------------------------
run docker hello world to test
------------------------------------------------------------------------------------------
immrsam@raspberrypi:~ $ docker container run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
2c7ed585684a: Pull complete 
Digest: sha256:393b81f0ea5a98a7335d7ad44be96fe76ca8eb2eaa76950eb8c989ebf2b78ec0
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (arm32v7)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/

immrsam@raspberrypi:~ $ docker container run hello-world

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (arm32v7)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
------------------------------------------------------------------------------------------


docker image pull debian
docker run -it -p 100:80 --name s3768719-debian debian
continue container: docker start -a -i `docker ps -q -l`
docker container start -ai s3768719-db

PREFIX=/home/s3768719/miniconda3
installing: python-3.4.3-1 ...
tar (child): bzip2: Cannot exec: No such file or directory
tar (child): Error is not recoverable: exiting now
tar: Child returned status 2
tar: Error is not recoverable: exiting now
s3768719@980b7cc8edbf:/$ 

docker tag local-image:tagname new-repo:tagname
docker push new-repo:tagname

docker save debian:buster | gzip > s3768719_db.tar.gz

==============================
--------Build Kernel----------
==============================
sudo apt install git bc bison flex libssl-dev make

git clone --depth=1 https://github.com/raspberrypi/linux

**Pi 4 32bit**
cd linux
KERNEL=kernel7l
make bcm2711_defconfig

edit .config
	CONFIG_LOCALVERSION="-v7l-MY_CUSTOM_KERNEL"

sudo apt-get install qt5-\*-dev

make xconfig

make -j4 Image modules dtbs

backup kernel - 
tar -c -f backup.tar /lib/modules/$s3768719 -r

sudo make modules_install
sudo cp arch/arm64/boot/dts/broadcom/*.dtb /boot/
sudo cp arch/arm64/boot/dts/overlays/*.dtb* /boot/overlays/
sudo cp arch/arm64/boot/dts/overlays/README /boot/overlays/
sudo cp arch/arm64/boot/Image /boot/$KERNEL.img

==============================
----------Scripts-------------
==============================

for dir in $dirs ; do count=$(sudo ls -l $dir 2>/dev/null | wc -l); echo $count $dir ; done | sort -n | head -5

==============================
-------Testing suit-----------
==============================
vim /etc/apt/sources.list
## comment all out and add following
deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi
deb http://mirrors.ustc.edu.cn/ubuntu-ports bionic main restricted multiverse universe

sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 3B4FE6ACC0B21F32
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 871920D1991BC93C

sudo apt update && sudo apt upgrade

sudo apt-get install php7.2-cli php7.2-cgi php7.2-common php-common php7.2-json php7.2-opcache php7.2-readline php7.2-xml
sudo apt-get install phoronix-test-suite

coremark CPU comprehensive performance benchmark test for measuring the performance of the central processing unit (CPU) used in embedded systems
 gmpbench CPU shaping operation score
 C-RAY CPU floating point calculation score (multi-threaded)
 sample-pi PI value operation
 openssl RSA encryption and decryption operations

sudo phoronix-test-suite install pts/coremark pts/gmpbench pts/c-ray  pts/openssl pts/sample-program

Shellcheck
https://github.com/koalaman/shellcheck/releases/download/stable/shellcheckstable.linux.armv6hf.tar.xz

tar -xf shellcheckstable.linux.armv6hf.tar.xz

==============================
--Remote access no password---
==============================
generate a new SSH key on your local system
$ ssh-keygen -t rsa
press Enter to accept all fields as defaults.

view the keypair generated
$ ls â€“l .ssh

copy Public Key to Remote Machine
$ ssh-copy-id remote_user@remote_IP

verify the transfer of the public key by viewing the authorized_keys file.
$ cat .ssh/authorized_keys

Set the permission on the authorized_keys file on the remote system
$ chmod 600 .ssh/authorized_keys
$ chmod 700 .ssh

==============================
---------VCGENCMD-------------
==============================
VCHI initialization failed Raspberry Pi Fixed

add user to video group

$ sudo usermod -aG video <username>
$ reboot

vcgencmd measure_temp | sed "s/temp=//;s/'C//"

awk 'NR==2 {print $2}' mem.txt

MEMFREE=$(free)
echo $MEMFREE
total used free shared buff/cache available Mem: 1917104 154632 1364944 40748 397528 1620060 Swap: 102396 0 102396
TOTALMEM=$(echo $MEMFREE | awk '{print $8}' )
echo $TOTALMEM
1917104

sudo apt install sysstat